// smn/user-ticket/backend/models/ticketModel.js
async function getIncrementingId(){const e = await Counter.findOne({}, "ticketId");return e ? e.ticketId + 1 : 1;}function padZeroes(e,t){return e.toString().padStart(t,"0")}import mongoose from"mongoose";import Counter from"../models/counterModel.js";const ticketSchema=new mongoose.Schema({user_id:{type:String,required:!0},mobile_number:{type:String,required:!0,validate:{validator:e=>/^\d{10}$/.test(e),message:"Please enter a valid 10-digit mobile number"}},location:{type:String,required:!0,trim:!0},issue_type:{type:String,required:!0,validate:{validator:e=>{console.log(`Validating issue_type: ${e}`);const t=["HARDWARE","SOFTWARE","NETWORK","OTHER"],i=t.includes(e.toUpperCase());return console.log(`isValid: ${i}`),i},message:"Invalid issue type"}},comments:{type:String,required:!0,trim:!0},ticket_id:{type:String,unique:!0},type:{type:String,default:"user"}},{timestamps:!0});ticketSchema.pre("save",function(e){const t=this;if(!t.ticket_id){const e="TKT-",i=getIncrementingId(),n=padZeroes(i,6);t.ticket_id=`${e}${n}`}e()});const Ticket=mongoose.model("Ticket",ticketSchema);export default Ticket;